<% if @user.photos.count == 0 %>
<div class="card card-block card-outline-secondary text-muted" style="border-style:dashed">
  <h3 class="card-title h5">Photos</h3>
  <p class="lead text-xs-center p-y-3">
    No photos<br>
    <small>Camera shy, maybe?</small>
  </p>
</div>
<% elsif @user.display_photos_to?(current_user) == false %>
<div class="card card-block card-outline-secondary text-muted" style="border-style:dashed">
  <h3 class="card-title h5">Photos</h3>
  <p class="text-xs-center p-a-3">
    <%= @user.photo_visibility.eql?('restricted') ? 'Restricted. They must like you before you can view their photos.' : 'Log in to view their photos.' %>
  </p>
</div>
<% else %>
<div class="card card-block card-no-border">
  <h3 class="card-title h5">Photos</h3>
  <div class="row">
    <% @user.photos.ranked.each do |photo| %>
      <div class="col-xs-4 col-sm-3" style="padding: 0.1em;">
        <%= image_tag(photo.image.url(:thumb), { class: 'img-fluid', data: { toggle: 'swipebox', rank: photo.rank } }) %>
      </div>
    <% end %>
  </div>
</div>

<%= content_for :javascripts do %>
<script>
<% if logged_in? %>
$('[data-toggle="swipebox"]').click(function () {
  $.swipebox(
    <%= @user.photos.ranked.collect { |p| { href: p.image.url } }.to_json.html_safe %>, {
      useCSS : true,
      useSVG : false,
      initialIndexOnArray : parseInt($(this).data('rank'), 10) - 1,
      removeBarsOnMobile : true,
      hideCloseButtonOnMobile : false
    }
  );
});
<% else %>
$('[data-toggle="swipebox"]').click(function () {
  $('#login-modal').modal('show');
});
<% end %>
</script>
<% end %>


<% end %>
